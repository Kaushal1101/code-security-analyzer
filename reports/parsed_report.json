[
  {
    "tool": "semgrep",
    "rule_id": "python.lang.security.audit.subprocess-shell-true.subprocess-shell-true",
    "file": "insecure_app.py",
    "line": 27,
    "column": 49,
    "severity": "ERROR",
    "confidence": "MEDIUM",
    "message": "Found 'subprocess' function 'call' with 'shell=True'. This is dangerous because this call will spawn the command using a shell process. Doing so propagates current shell settings and variables, which makes it much easier for a malicious actor to execute commands. Use 'shell=False' instead.",
    "cwe": [
      "CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"
    ],
    "owasp": [
      "A01:2017 - Injection",
      "A03:2021 - Injection",
      "A05:2025 - Injection"
    ],
    "category": "security",
    "vulnerability_class": [
      "Command Injection"
    ],
    "references": [
      "https://stackoverflow.com/questions/3172470/actual-meaning-of-shell-true-in-subprocess",
      "https://docs.python.org/3/library/subprocess.html"
    ],
    "source": "https://semgrep.dev/r/python.lang.security.audit.subprocess-shell-true.subprocess-shell-true"
  },
  {
    "tool": "semgrep",
    "rule_id": "python.flask.security.injection.user-eval.eval-injection",
    "file": "insecure_app.py",
    "line": 37,
    "column": 16,
    "severity": "ERROR",
    "confidence": "MEDIUM",
    "message": "Detected user data flowing into eval. This is code injection and should be avoided.",
    "cwe": [
      "CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection')"
    ],
    "owasp": [
      "A03:2021 - Injection",
      "A05:2025 - Injection"
    ],
    "category": "security",
    "vulnerability_class": [
      "Code Injection"
    ],
    "references": [
      "https://nedbatchelder.com/blog/201206/eval_really_is_dangerous.html"
    ],
    "source": "https://semgrep.dev/r/python.flask.security.injection.user-eval.eval-injection"
  },
  {
    "filename": "./insecure_app.py",
    "issue_text": "Use of weak MD5 hash for security. Consider usedforsecurity=False",
    "line_number": 15,
    "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b324_hashlib.html",
    "test_id": "B324",
    "test_name": "hashlib",
    "tool": "bandit",
    "code_snippet": "14 def hash_password(password):\n15     return hashlib.md5(password.encode()).hexdigest()\n16 \n",
    "confidence": "HIGH",
    "severity": "HIGH",
    "CWE": {
      "id": 327,
      "link": "https://cwe.mitre.org/data/definitions/327.html"
    }
  },
  {
    "filename": "./insecure_app.py",
    "issue_text": "subprocess call with shell=True identified, security issue.",
    "line_number": 27,
    "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b602_subprocess_popen_with_shell_equals_true.html",
    "test_id": "B602",
    "test_name": "subprocess_popen_with_shell_equals_true",
    "tool": "bandit",
    "code_snippet": "26 def delete_file(filename):\n27     subprocess.call(\"rm -rf \" + filename, shell=True)\n28 \n",
    "confidence": "HIGH",
    "severity": "HIGH",
    "CWE": {
      "id": 78,
      "link": "https://cwe.mitre.org/data/definitions/78.html"
    }
  },
  {
    "filename": "./insecure_app.py",
    "issue_text": "A Flask app appears to be run with debug=True, which exposes the Werkzeug debugger and allows the execution of arbitrary code.",
    "line_number": 41,
    "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b201_flask_debug_true.html",
    "test_id": "B201",
    "test_name": "flask_debug_true",
    "tool": "bandit",
    "code_snippet": "40 if __name__ == \"__main__\":\n41     app.run(debug=True)\n42 \n",
    "confidence": "MEDIUM",
    "severity": "HIGH",
    "CWE": {
      "id": 94,
      "link": "https://cwe.mitre.org/data/definitions/94.html"
    }
  }
]